<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Generador de Mazmorras</title>
    <style>
        body {
            background-color: #111;
            color: white;
            font-family: 'Segoe UI', sans-serif;
            text-align: center;
            margin: 0;
            padding: 20px;
        }
        .btn {
            background-color: #333;
            color: white;
            padding: 10px 20px;
            border: none;
            margin: 10px;
            cursor: pointer;
            font-size: 16px;
        }
        .btn:hover {
            background-color: #555;
        }
        #mapa {
            margin-top: 20px;
            background-color: white;
            display: inline-block;
            padding: 20px;
        }
    </style>
</head>
<body>
    <h1>ðŸ§­ Generador de Mazmorras</h1>
    <button class="btn" onclick="generarMazmorra()">Generar Mazmorra</button>
    <input type="number" id="nivel" min="1" max="100" value="1" class="btn" style="width: 80px;">
    <br>
    <input type="file" id="archivoJSON" accept=".json" style="margin-top: 20px; color: white;">
    <button class="btn" onclick="cargarDesdeJSON()">Cargar desde JSON</button>

    <div id="mapa"></div>

    <script>
        let svgTexto = '';
        let datosJSON = {};

        function generarMazmorra() {
            const nivel = document.getElementById("nivel").value;
            fetch(`/generar?nivel=${nivel}`)
                .then(res => res.json())
                .then(data => {
                    svgTexto = data.svg;
                    datosJSON = data.json;
                    document.getElementById("mapa").innerHTML = svgTexto;
                });
        }

        function cargarDesdeJSON() {
            const input = document.getElementById('archivoJSON');
            if (!input.files[0]) return alert("Selecciona un archivo JSON primero.");

            const formData = new FormData();
            formData.append('archivo', input.files[0]);

            fetch('/cargar', {
                method: 'POST',
                body: formData
            })
            .then(res => res.json())
            .then(data => {
                svgTexto = data.svg;
                datosJSON = data.json;
                document.getElementById('mapa').innerHTML = svgTexto;
            });
        }
    </script>
</body>
</html>